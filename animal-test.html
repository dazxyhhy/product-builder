<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>íë§ ì‰¼í„° - ë™ë¬¼ìƒ í…ŒìŠ¤íŠ¸</title>
    <meta name="description" content="AIê°€ ë¶„ì„í•˜ëŠ” ë‚˜ì˜ ë™ë¬¼ìƒì€? ê°•ì•„ì§€ìƒ, ê³ ì–‘ì´ìƒ ë“± ë‚´ ì–¼êµ´ì— ìˆ¨ê²¨ì§„ ë™ë¬¼ ì˜í˜¼ì„ ì°¾ì•„ë³´ì„¸ìš”." />
    <link rel="canonical" href="https://product-builder-3d5.pages.dev/animal-test.html" />

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="íë§ ì‰¼í„° - ë‚˜ì˜ ë™ë¬¼ìƒ ì°¾ê¸°" />
    <meta property="og:description" content="AIê°€ ë¶„ì„í•´ì£¼ëŠ” ë‚˜ì˜ ë™ë¬¼ìƒ í…ŒìŠ¤íŠ¸. ë‹¹ì‹ ì€ ê°•ì•„ì§€ìƒì¼ê¹Œìš”, ê³ ì–‘ì´ìƒì¼ê¹Œìš”?" />
    <meta property="og:image" content="https://product-builder-3d5.pages.dev/assets/main-image.png" />

    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ¾</text></svg>" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DLFQSNY2FE"></script>
    <script>
      window.dataLayer = window.dataLayer || []
      function gtag() {
        dataLayer.push(arguments)
      }
      gtag("js", new Date())

      gtag("config", "G-DLFQSNY2FE")
    </script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2307043093255162" crossorigin="anonymous"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Nanum+Myeongjo:wght@400;700;800&family=Libre+Barcode+39&display=swap");

      :root {
        /* Common */
        --btn-border: #b8860b;
        --btn-text: #b8860b;
        --btn-hover-bg: #b8860b;
        --btn-hover-text: #1a1a1a;
        --mystic-text-color: rgba(184, 134, 11, 0.6);
        --shadow-color: rgba(184, 134, 11, 0.5);
        --header-bg: rgba(0, 0, 0, 0.2);

        /* Default (Dark Mode) */
        --bg-color: #1a1a1a;
        --text-color: #b8860b;
        --bg-image: radial-gradient(circle at 50% 50%, rgba(184, 134, 11, 0.1) 0%, transparent 70%), url("https://www.transparenttextures.com/patterns/dark-leather.png");
      }

      [data-theme="light"] {
        /* Light Mode */
        --bg-color: #e8e4d9;
        --text-color: #5d4037;
        --bg-image: radial-gradient(circle at 50% 50%, rgba(93, 64, 55, 0.05) 0%, transparent 70%), url("https://www.transparenttextures.com/patterns/cream-paper.png");
        --btn-border: #5d4037;
        --btn-text: #5d4037;
        --btn-hover-bg: #5d4037;
        --btn-hover-text: #e8e4d9;
        --mystic-text-color: rgba(93, 64, 55, 0.7);
        --shadow-color: rgba(93, 64, 55, 0.3);
        --header-bg: rgba(255, 255, 255, 0.2);
      }

      body {
        background-color: var(--bg-color);
        background-image: var(--bg-image);
        font-family: "Nanum Myeongjo", serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 100vh;
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        color: var(--text-color);
        overflow-x: hidden;
        transition: background 0.5s ease, color 0.5s ease;
      }

      /* === Header Navigation === */
      .main-header {
        width: 100%;
        position: fixed;
        top: 0;
        left: 0;
        height: 60px;
        background: transparent;
        backdrop-filter: none;
        -webkit-backdrop-filter: none;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 30px;
        box-sizing: border-box;
        z-index: 1000;
        transition: background 0.4s ease, backdrop-filter 0.4s ease, border-bottom 0.4s ease;
        border-bottom: 1px solid transparent;
      }

      .main-header.scrolled {
        background: var(--header-bg);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-bottom: 1px solid rgba(184, 134, 11, 0.1);
      }

      .logo-area {
        font-family: "Cinzel", serif;
        font-weight: 900;
        font-size: 1.2rem;
        color: var(--text-color);
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .nav-menu {
        display: flex;
        gap: 20px;
      }

      .nav-item {
        color: var(--text-color);
        text-decoration: none;
        font-size: 0.95rem;
        font-weight: 700;
        opacity: 0.8;
        transition: all 0.3s;
        font-family: "Cinzel", serif;
        letter-spacing: 1px;
      }
      .nav-item:lang(ko) {
        font-family: "Nanum Myeongjo", serif;
      }

      .nav-item:hover {
        opacity: 1;
        text-shadow: 0 0 10px var(--shadow-color);
      }

      .desktop-theme-toggle {
        opacity: 0.8 !important;
      }

      .desktop-theme-toggle:hover {
        opacity: 1 !important;
        text-shadow: 0 0 5px var(--shadow-color);
      }

      /* === Mobile Drawer Styles === */
      .mobile-header-controls {
        display: none;
      }

      .hamburger-btn {
        background: transparent;
        border: none;
        color: var(--text-color);
        font-size: 1.5rem;
        cursor: pointer;
        padding: 5px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-left: 10px;
      }

      .mobile-drawer {
        position: fixed;
        top: 0;
        right: -280px;
        width: 260px;
        height: 100vh;
        background: var(--bg-color);
        border-left: 1px solid var(--btn-border);
        box-shadow: -5px 0 15px rgba(0, 0, 0, 0.5);
        z-index: 2000;
        transition: right 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        padding: 20px;
        display: flex;
        flex-direction: column;
        box-sizing: border-box;
      }

      .mobile-drawer.open {
        right: 0;
      }

      .drawer-header {
        width: 100%;
        padding-bottom: 10px;
        border-bottom: 1px solid rgba(184, 134, 11, 0.2);
        margin-bottom: 20px !important;
      }

      .close-btn {
        background: transparent;
        border: none;
        color: var(--text-color);
        font-size: 2.2rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        line-height: 1;
      }

      .drawer-nav {
        display: flex;
        flex-direction: column;
        gap: 25px;
      }

      .drawer-item {
        color: var(--text-color);
        text-decoration: none;
        font-size: 1.1rem;
        font-weight: bold;
        padding-bottom: 10px;
        border-bottom: 1px dashed rgba(184, 134, 11, 0.3);
        font-family: "Nanum Myeongjo", serif;
        display: block;
      }

      /* Overlay */
      .drawer-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        z-index: 1500;
        display: none;
        opacity: 0;
        transition: opacity 0.3s;
        backdrop-filter: blur(3px);
      }
      .drawer-overlay.active {
        display: block;
        opacity: 1;
      }

      /* === Main Layout === */
      .container {
        width: 100%;
        max-width: 600px;
        padding: 80px 20px 60px 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        flex: 1;
        transition: max-width 0.5s ease;
        box-sizing: border-box;
      }

      .container.result-mode {
        max-width: 1100px;
      }

      .content-wrapper {
        display: flex;
        flex-direction: column;
        width: 100%;
        justify-content: center;
        align-items: center;
        gap: 30px;
        margin-top: 20px;
        transition: all 0.5s ease;
      }

      .container.result-mode .content-wrapper {
        flex-direction: row;
        align-items: flex-start;
        gap: 50px;
      }

      .left-panel,
      .right-panel {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
        max-width: 500px;
        transition: all 0.5s ease;
      }

      h1 {
        font-family: "Cinzel", serif;
        font-size: 2.5rem;
        margin: 0 0 10px 0;
        color: var(--text-color);
        text-shadow: 0 0 10px var(--shadow-color);
        word-break: keep-all;
      }

      p.subtitle {
        color: var(--mystic-text-color);
        margin-bottom: 20px;
        font-size: 1rem;
        line-height: 1.6;
        word-break: keep-all;
      }

      /* Upload Area */
      .upload-area {
        border: 2px dashed var(--btn-border);
        border-radius: 10px;
        padding: 20px;
        cursor: pointer;
        transition: background 0.3s, min-height 0.3s;
        position: relative;
        overflow: hidden;
        min-height: 300px;
        width: 100%;
        max-width: 400px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
        box-sizing: border-box;
      }

      .container.result-mode .upload-area {
        min-height: 400px;
        max-width: 100%;
      }

      .upload-area:hover {
        background: rgba(184, 134, 11, 0.1);
      }

      .upload-area input {
        display: none;
      }

      .preview-img {
        max-width: 100%;
        max-height: 100%;
        width: auto;
        border-radius: 6px;
        display: none;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        object-fit: contain;
      }

      .upload-label {
        font-size: 1rem;
        color: var(--text-color);
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        pointer-events: none;
      }

      .icon {
        font-size: 3rem;
      }

      /* Result Area */
      .result-area {
        display: none;
        animation: fadeIn 0.5s ease;
        width: 100%;
      }

      .result-title {
        font-size: 1.8rem;
        font-weight: bold;
        margin-bottom: 20px;
        color: var(--text-color);
      }

      .result-desc {
        font-size: 1rem;
        color: var(--mystic-text-color);
        margin-bottom: 25px;
        word-break: keep-all;
        line-height: 1.6;
        background: rgba(184, 134, 11, 0.05);
        padding: 20px;
        border-radius: 8px;
        border: 1px solid rgba(184, 134, 11, 0.1);
        width: 100%;
        box-sizing: border-box;
      }

      [data-theme="light"] .result-desc {
        background: rgba(93, 64, 55, 0.05);
        border-color: rgba(93, 64, 55, 0.1);
      }

      .bar-container {
        width: 100%;
        background-color: rgba(0, 0, 0, 0.2);
        border-radius: 10px;
        margin: 10px 0;
        overflow: hidden;
        height: 24px;
        position: relative;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      [data-theme="light"] .bar-container {
        background-color: rgba(0, 0, 0, 0.05);
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      .bar-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--btn-border), var(--text-color));
        width: 0%;
        transition: width 1s ease-in-out;
        border-radius: 10px;
      }

      .bar-text {
        display: flex;
        justify-content: space-between;
        font-size: 0.9rem;
        color: var(--mystic-text-color);
        margin-bottom: 5px;
        margin-top: 15px;
        font-weight: bold;
      }

      /* Buttons */
      .btn {
        background: transparent;
        border: 2px solid var(--btn-border);
        color: var(--btn-text);
        padding: 12px 30px;
        font-family: "Cinzel", serif;
        font-weight: 700;
        font-size: 1.1rem;
        cursor: pointer;
        transition: all 0.3s;
        position: relative;
        overflow: hidden;
        white-space: nowrap;
        text-decoration: none;
        display: inline-block;
        margin-top: 20px;
        border-radius: 4px;
        width: 100%;
        max-width: 400px;
      }

      .btn:hover {
        background: var(--btn-hover-bg);
        color: var(--btn-hover-text);
        box-shadow: 0 0 20px var(--shadow-color);
      }

      .loading {
        display: none;
        margin-top: 30px;
        color: var(--mystic-text-color);
        font-style: italic;
        font-size: 1rem;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Loading Spinner */
      .spinner {
        display: inline-block;
        width: 40px;
        height: 40px;
        border: 4px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: var(--text-color);
        animation: spin 1s ease-in-out infinite;
        margin-bottom: 10px;
      }
      [data-theme="light"] .spinner {
        border: 4px solid rgba(0, 0, 0, 0.1);
        border-top-color: var(--text-color);
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      footer {
        width: 100%;
        text-align: center;
        padding: 20px;
        margin-top: auto;
        font-size: 0.8rem;
        opacity: 0.6;
        border-top: 1px solid rgba(184, 134, 11, 0.1);
      }

      @media (max-width: 900px) {
        .main-header {
          justify-content: space-between;
          padding: 0 25px;
        }
        .nav-menu {
          display: none;
        }
        .desktop-theme-toggle {
          display: none !important;
        }
        .mobile-header-controls {
          display: flex;
          align-items: center;
          gap: 15px;
        }
        .logo-area {
          font-size: 1.3rem;
        }

        .container,
        .container.result-mode {
          padding: 100px 20px 60px 20px;
          max-width: 100%;
        }

        h1 {
          font-size: 2rem;
        }

        .content-wrapper,
        .container.result-mode .content-wrapper {
          flex-direction: column;
          align-items: center;
          gap: 30px;
        }

        .upload-area,
        .container.result-mode .upload-area {
          min-height: 300px;
          max-width: 400px;
        }

        .result-area {
          border-top: 1px dashed var(--btn-border);
          padding-top: 30px;
        }
      }

      @media (max-width: 600px) {
        h1 {
          font-size: 1.8rem;
          word-break: keep-all;
        }
        .subtitle {
          font-size: 0.9rem;
          margin-bottom: 30px;
        }
        .upload-area,
        .container.result-mode .upload-area {
          min-height: 250px;
          width: 90%;
        }
        .btn {
          width: 90%;
          max-width: 320px;
          box-sizing: border-box;
        }
        .result-desc {
          width: 90%;
        }
      }
    </style>
  </head>
  <body>
    <!-- Overlay for Drawer -->
    <div class="drawer-overlay" id="drawerOverlay"></div>

    <!-- Global Header -->
    <header class="main-header">
      <a href="index.html" class="logo-area">
        <span style="font-size: 1.5rem">ğŸ’</span>
        MRL
      </a>

      <!-- Desktop Menu -->
      <nav class="nav-menu">
        <a href="dream-lotto.html" class="nav-item">DREAM</a>
        <a href="animal-test.html" class="nav-item">ANIMAL</a>
        <a href="blog.html" class="nav-item">ARCHIVE</a>
        <a href="share-luck.html" class="nav-item">COMMUNITY</a>
        <a href="contact.html" class="nav-item">CONTACT</a>
      </nav>

      <button
        id="desktopThemeToggleText"
        style="
          background: transparent;
          border: none;
          color: var(--mystic-text-color);
          font-family: 'Nanum Myeongjo', serif;
          font-size: 0.9rem;
          cursor: pointer;
          display: flex;
          align-items: center;
          gap: 8px;
          opacity: 0.8;
          transition: opacity 0.3s;
        "
        class="desktop-theme-toggle"
      >
        <span>ë‹¤í¬ ëª¨ë“œ</span>
        <span id="desktopThemeStatus" style="font-weight: bold; color: var(--text-color)">ON</span>
      </button>

      <!-- Mobile Controls -->
      <div class="mobile-header-controls">
        <button class="hamburger-btn" id="menuBtn" aria-label="Open Menu">â˜°</button>
      </div>
    </header>

    <!-- Mobile Drawer -->
    <div class="mobile-drawer" id="mobileDrawer">
      <div class="drawer-header" style="display: flex; justify-content: flex-end; align-items: center; margin-bottom: 30px">
        <button class="close-btn" id="closeBtn" style="margin: 0">Ã—</button>
      </div>
      <nav class="drawer-nav" style="flex-grow: 1">
        <a href="dream-lotto.html" class="drawer-item">ğŸŒ™ ê¿ˆí•´ëª½ ë³€í™˜ê¸°</a>
        <a href="animal-test.html" class="drawer-item">ğŸ¾ ë™ë¬¼ìƒ í…ŒìŠ¤íŠ¸</a>
        <a href="blog.html" class="drawer-item">ğŸ“œ ìš´ëª…ì˜ ê¸°ë¡ê´€</a>
        <a href="share-luck.html" class="drawer-item">ğŸ’¬ í–‰ìš´ ê³µìœ ì†Œ</a>
        <a href="contact.html" class="drawer-item">âœ‰ï¸ ì˜ˆì–¸ ì‹ ì²­</a>
      </nav>
      <div class="drawer-footer" style="margin-top: auto; padding-top: 20px; border-top: 1px solid rgba(184, 134, 11, 0.1)">
        <button
          id="mobileThemeToggleText"
          style="
            background: transparent;
            border: none;
            color: var(--mystic-text-color);
            font-family: 'Nanum Myeongjo', serif;
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            padding: 10px 0;
            opacity: 0.8;
          "
        >
          <span>ë‹¤í¬ ëª¨ë“œ</span>
          <span id="themeStatus" style="font-weight: bold; color: var(--text-color)">ON</span>
        </button>
      </div>
    </div>

    <div class="container">
      <h1>íë§ ì‰¼í„°</h1>
      <p class="subtitle">
        ë‹¹ì‹ ì˜ ì˜í˜¼ì€ ì–´ë–¤ ë™ë¬¼ê³¼ ë‹®ì•„ìˆì„ê¹Œìš”?
        <br />
        ì‚¬ì§„ì„ ì˜¬ë ¤ì£¼ì‹œë©´ ì¸ê³µì§€ëŠ¥ì´ ë¶„ì„í•´ë“œë¦½ë‹ˆë‹¤.
      </p>

      <div class="content-wrapper">
        <div class="left-panel">
          <div class="upload-area" id="uploadArea">
            <input type="file" id="imageInput" accept="image/*" />
            <div class="upload-label" id="uploadLabel">
              <span class="icon">ğŸ“¸</span>
              <span>í´ë¦­í•˜ì—¬ ì‚¬ì§„ ì—…ë¡œë“œ</span>
            </div>
            <img id="previewImage" class="preview-img" alt="Preview" />
          </div>
          <button class="btn" id="predictBtn" style="display: none" onclick="predict()">ë¶„ì„ ì‹œì‘í•˜ê¸°</button>
        </div>

        <div class="right-panel">
          <div class="loading" id="loadingBox">
            <div class="spinner"></div>
            <br />
            ìš´ëª…ì˜ ê±°ìš¸ì„ ë‹¦ê³  ìˆìŠµë‹ˆë‹¤...
            <br />
            <span style="font-size: 0.75rem">(ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”)</span>
          </div>

          <div class="result-area" id="resultArea">
            <div class="result-title" id="resultTitle">ë¶„ì„ ê²°ê³¼</div>
            <div class="result-desc" id="resultDesc"></div>
            <div id="labelContainer"></div>
            <button class="btn" id="retryBtn" style="display: none" onclick="retry()">ë‹¤ë¥¸ ì‚¬ì§„ ë¶„ì„í•˜ê¸°</button>
          </div>
        </div>
      </div>

      <a
        href="index.html"
        class="back-link"
        style="margin-top: 40px; display: inline-block; color: var(--mystic-text-color); text-decoration: none; font-size: 0.9rem; border-bottom: 1px dashed var(--mystic-text-color)"
      >
        â† ì˜ˆì–¸ì†Œë¡œ ëŒì•„ê°€ê¸°
      </a>
    </div>

    <footer>
      <a href="privacy.html" style="color: inherit; margin-right: 15px; text-decoration: none">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>
      <span>Â© 2026 Mystic Ring Lotto</span>
    </footer>

    <!-- Tensorflow & Teachable Machine Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>

    <script>
      // âš ï¸ Teachable Machine Link âš ï¸
      const URL = "https://teachablemachine.withgoogle.com/models/15RFyCSxl/"

      let model, maxPredictions

      const uploadArea = document.getElementById("uploadArea")
      const imageInput = document.getElementById("imageInput")
      const uploadLabel = document.getElementById("uploadLabel")
      const previewImage = document.getElementById("previewImage")
      const loadingBox = document.getElementById("loadingBox")
      const resultArea = document.getElementById("resultArea")
      const resultTitle = document.getElementById("resultTitle")
      const resultDesc = document.getElementById("resultDesc")
      const labelContainer = document.getElementById("labelContainer")
      const predictBtn = document.getElementById("predictBtn")
      const retryBtn = document.getElementById("retryBtn")

      // Header & Drawer Logic
      const menuBtn = document.getElementById("menuBtn")
      const closeBtn = document.getElementById("closeBtn")
      const mobileDrawer = document.getElementById("mobileDrawer")
      const overlay = document.getElementById("drawerOverlay")

      function openDrawer() {
        mobileDrawer.classList.add("open")
        overlay.classList.add("active")
        document.body.style.overflow = "hidden"
      }

      function closeDrawer() {
        mobileDrawer.classList.remove("open")
        overlay.classList.remove("active")
        document.body.style.overflow = ""
      }

      if (menuBtn) menuBtn.addEventListener("click", openDrawer)
      if (closeBtn) closeBtn.addEventListener("click", closeDrawer)
      if (overlay) overlay.addEventListener("click", closeDrawer)

      // Header Scroll Effect
      const header = document.querySelector(".main-header")
      window.addEventListener("scroll", () => {
        if (window.scrollY > 50) {
          header.classList.add("scrolled")
        } else {
          header.classList.remove("scrolled")
        }
      })

      // Theme Logic (Unified)
      const desktopThemeToggleText = document.getElementById("desktopThemeToggleText")
      const desktopThemeStatus = document.getElementById("desktopThemeStatus")
      const mobileThemeToggleText = document.getElementById("mobileThemeToggleText")
      const themeStatus = document.getElementById("themeStatus")

      let isDark = true
      const savedTheme = localStorage.getItem("theme")

      function updateThemeUI(dark) {
        if (dark) {
          document.documentElement.removeAttribute("data-theme")
          if (desktopThemeStatus) desktopThemeStatus.textContent = "ON"
          if (themeStatus) themeStatus.textContent = "ON"
        } else {
          document.documentElement.setAttribute("data-theme", "light")
          if (desktopThemeStatus) desktopThemeStatus.textContent = "OFF"
          if (themeStatus) themeStatus.textContent = "OFF"
        }
      }

      if (savedTheme === "light") {
        isDark = false
        updateThemeUI(false)
      } else {
        updateThemeUI(true)
      }

      function toggleTheme() {
        isDark = !isDark
        updateThemeUI(isDark)
        localStorage.setItem("theme", isDark ? "dark" : "light")
      }

      if (desktopThemeToggleText) desktopThemeToggleText.addEventListener("click", toggleTheme)
      if (mobileThemeToggleText) mobileThemeToggleText.addEventListener("click", toggleTheme)

      // Initialize Model
      async function init() {
        try {
          if (URL.includes("YOUR_MODEL_ID")) {
            alert("ëª¨ë¸ ì—°ê²°ì´ í•„ìš”í•©ë‹ˆë‹¤! ì½”ë“œë¥¼ ì—´ì–´ URL ë³€ìˆ˜ì— í‹°ì²˜ë¸” ë¨¸ì‹  ë§í¬ë¥¼ ë„£ì–´ì£¼ì„¸ìš”.")
            loadingBox.style.display = "none"
            predictBtn.style.display = "inline-block"
            return
          }

          const modelURL = URL + "model.json"
          const metadataURL = URL + "metadata.json"
          model = await tmImage.load(modelURL, metadataURL)
          maxPredictions = model.getTotalClasses()
        } catch (e) {
          console.error("Model load failed:", e)
          alert("ëª¨ë¸ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì¸í„°ë„· ì—°ê²°ì´ë‚˜ ë§í¬ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.")
          loadingBox.style.display = "none"
          predictBtn.style.display = "inline-block"
        }
      }

      // Upload Logic
      uploadArea.addEventListener("click", () => imageInput.click())

      imageInput.addEventListener("change", (e) => {
        const file = e.target.files[0]
        if (file) {
          const reader = new FileReader()
          reader.onload = (event) => {
            previewImage.src = event.target.result
            previewImage.style.display = "block"
            uploadLabel.style.display = "none"
            resultArea.style.display = "none"
            predictBtn.style.display = "inline-block"
            retryBtn.style.display = "none"

            // Reset layout just in case
            document.querySelector(".container").classList.remove("result-mode")
          }
          reader.readAsDataURL(file)
        }
      })

      // Retry Logic (Reset to initial state)
      function retry() {
        previewImage.src = ""
        previewImage.style.display = "none"
        uploadLabel.style.display = "flex"
        resultArea.style.display = "none"
        loadingBox.style.display = "none"
        predictBtn.style.display = "none"
        retryBtn.style.display = "none"
        imageInput.value = "" // Clear file input

        document.querySelector(".container").classList.remove("result-mode")
      }

      // Prediction Logic
      async function predict() {
        loadingBox.style.display = "block"
        predictBtn.style.display = "none"
        resultArea.style.display = "none"

        if (!model) {
          await init()
          if (!model) return // Stop if init failed
        }

        // Slight delay for UI update
        setTimeout(async () => {
          const prediction = await model.predict(previewImage)

          // Sort by probability
          prediction.sort((a, b) => b.probability - a.probability)

          const bestClass = prediction[0].className

          if (bestClass.includes("ê°•ì•„ì§€") || bestClass.includes("Dog")) {
            resultTitle.textContent = "ğŸ¶ ë‹¹ì‹ ì€ 'ê°•ì•„ì§€ìƒ'ì…ë‹ˆë‹¤!"
            resultDesc.textContent = "ì¶©ì„±ì‹¬ì´ ê°•í•˜ê³  í™œë°œí•˜ë©°, ì£¼ë³€ ì‚¬ëŒë“¤ì—ê²Œ ì‚¬ë‘ë°›ëŠ” ë”°ëœ»í•œ ë§ˆìŒì„ ê°€ì§€ì…¨êµ°ìš”."
          } else if (bestClass.includes("ê³ ì–‘ì´") || bestClass.includes("Cat")) {
            resultTitle.textContent = "ğŸ± ë‹¹ì‹ ì€ 'ê³ ì–‘ì´ìƒ'ì…ë‹ˆë‹¤!"
            resultDesc.textContent = "ë„ë„í•˜ê³  ë§¤ë ¥ì ì´ë©°, ë…ë¦½ì‹¬ì´ ê°•í•˜ì§€ë§Œ ë‚´ ì‚¬ëŒì—ê²ŒëŠ” í•œì—†ì´ ë‹¤ì •í•œ ë°˜ì „ ë§¤ë ¥ì˜ ì†Œìœ ìì‹œêµ°ìš”."
          } else if (bestClass.includes("í† ë¼") || bestClass.includes("Rabbit")) {
            resultTitle.textContent = "ğŸ° ë‹¹ì‹ ì€ 'í† ë¼ìƒ'ì…ë‹ˆë‹¤!"
            resultDesc.textContent = "ìˆœìˆ˜í•˜ê³  ê·€ì—¬ìš´ ë§¤ë ¥ìœ¼ë¡œ ì–´ë””ì„œë‚˜ ì‚¬ë‘ë°›ëŠ” ë¶„ìœ„ê¸° ë©”ì´ì»¤ì‹œêµ°ìš”."
          } else if (bestClass.includes("ì—¬ìš°") || bestClass.includes("Fox")) {
            resultTitle.textContent = "ğŸ¦Š ë‹¹ì‹ ì€ 'ì—¬ìš°ìƒ'ì…ë‹ˆë‹¤!"
            resultDesc.textContent = "ëˆˆì¹˜ê°€ ë¹ ë¥´ê³  ì„¼ìŠ¤ ë„˜ì¹˜ë©°, ì‚¬ëŒì˜ ë§ˆìŒì„ ì‚¬ë¡œì¡ëŠ” ë§¤ë ¥ì„ ì§€ë‹ˆì…¨êµ°ìš”."
          } else if (bestClass.includes("ê³°") || bestClass.includes("Bear")) {
            resultTitle.textContent = "ğŸ» ë‹¹ì‹ ì€ 'ê³°ìƒ'ì…ë‹ˆë‹¤!"
            resultDesc.textContent = "ë“¬ì§í•˜ê³  í¬ê·¼í•˜ë©°, ì£¼ë³€ ì‚¬ëŒë“¤ì—ê²Œ í¸ì•ˆí•¨ì„ ì£¼ëŠ” ë“ ë“ í•œ ì¡´ì¬ì‹œêµ°ìš”."
          } else {
            resultTitle.textContent = `ğŸ§ ë‹¹ì‹ ì€ '${bestClass}ìƒ'ì…ë‹ˆë‹¤!`
            resultDesc.textContent = "ë…íŠ¹í•˜ê³  ì‹ ë¹„ë¡œìš´ ë§¤ë ¥ì„ ê°€ì§€ê³  ê³„ì‹œë„¤ìš”."
          }

          // Create bars
          labelContainer.innerHTML = ""
          for (let i = 0; i < maxPredictions; i++) {
            const classPrediction = prediction[i]
            const probability = (classPrediction.probability * 100).toFixed(1)

            if (probability > 1) {
              const barDiv = document.createElement("div")
              barDiv.innerHTML = `
                            <div class="bar-text">
                                <span>${classPrediction.className}</span>
                                <span>${probability}%</span>
                            </div>
                            <div class="bar-container">
                                <div class="bar-fill" style="width: ${probability}%"></div>
                            </div>
                        `
              labelContainer.appendChild(barDiv)
            }
          }

          loadingBox.style.display = "none"
          resultArea.style.display = "block"

          // Show Retry Button instead of Predict Button
          retryBtn.style.display = "inline-block"

          // Switch to result layout
          document.querySelector(".container").classList.add("result-mode")
        }, 500)
      }
    </script>
  </body>
</html>
